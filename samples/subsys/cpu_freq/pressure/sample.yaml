sample:
  description: CPU frequency scaling pressure policy sample
  name: CPU Freq Pressure Sample
common:
  tags: cpu_freq
  harness: console
  harness_config:
    type: multi_line
    regex:
      - "^.*<inf> cpu_freq_pressure_sample: Mode 1: Low only"
      - "^.*<dbg> cpu_freq_policy_pressure: thread_eval_cb: Evaluating thread: 0x[0-9a-fA-F]+ \
         with prio: [0-9]+ status: [0-9]+"
      - "^.*<dbg> cpu_freq_policy_pressure: thread_eval_cb: Evaluating thread: 0x[0-9a-fA-F]+ \
         with prio: [0-9]+ status: [0-9]+"
      - "^.*<dbg> cpu_freq_policy_pressure: thread_eval_cb: Evaluating thread: 0x[0-9a-fA-F]+ \
         with prio: [0-9]+ status: [0-9]+"
      - "^.*<dbg> cpu_freq_policy_pressure: thread_eval_cb: Evaluating thread: 0x[0-9a-fA-F]+ \
         with prio: [0-9]+ status: [0-9]+"
      - "^.*<dbg> cpu_freq_policy_pressure: thread_eval_cb: Evaluating thread: 0x[0-9a-fA-F]+ \
         with prio: [0-9]+ status: [0-9]+"
      - "^.*<dbg> cpu_freq_policy_pressure: get_normalized_sys_pressure: System pressure is: \
         [0-9]+% \\(raw: [0-9]+ / max: [0-9]+\\)"
      - "^.*<dbg> cpu_freq_policy_pressure: cpu_freq_policy_select_pstate: CPU[0-9]+ Pressure: \
         [0-9]+%"
      - "^.*<dbg> cpu_freq_policy_pressure: cpu_freq_policy_select_pstate: Pressure Policy: \
         Selected P-state [0-9]+ with load_threshold=[0-9]+%"

tests:
  sample.cpu_freq_pressure:
    integration_platforms:
      - native_sim
      - native_sim/native/64
      - frdm_mcxn236
    platform_allow:
      - native_sim
      - native_sim/native/64
      - frdm_mcxn236
