common:
  sysbuild: true
  depends_on: spi
  tags:
    - spi
  harness: console
  harness_config:
    fixture: spi_loopback
    type: multi_line
    ordered: true
    regex:
      - ".*SPIS: waiting for SPI transfer"
      - ".*SPIS: woken up by"

sample:
  name: SPI wakeup sample
tests:
  sample.drivers.spis.wakeup:
    platform_allow:
      - nrf54h20dk/nrf54h20/cpuapp
    integration_platforms:
      - nrf54h20dk/nrf54h20/cpuapp
  sample.drivers.spis.wakeup.ppr:
    platform_allow:
      - nrf54h20dk/nrf54h20/cpuapp
    integration_platforms:
      - nrf54h20dk/nrf54h20/cpuapp
    extra_args:
      - SB_CONFIG_REMOTE_NRF54H20_CPUPPR_CORE=y
      - spis_wakeup_CONFIG_SOC_NRF54H20_CPURAD_ENABLE=n
      - spis_wakeup_SNIPPET=nordic-ppr-xip
      - DTC_OVERLAY_FILE="boards/nrf54h20dk_nrf54h20_cpuapp_with_cpuppr.overlay"
