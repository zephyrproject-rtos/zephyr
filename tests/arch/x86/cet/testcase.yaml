common:
  ignore_faults: true
  tags:
    - kernel
    - cet
  filter: CONFIG_X86_CPU_HAS_CET

tests:
  arch.x86.cet.kernel.ibt32:
    arch_allow: x86
    filter: not CONFIG_X86_64
    extra_configs:
      - CONFIG_X86_CET_IBT=y
      - CONFIG_DEBUG_COREDUMP=y
  arch.x86.cet.kernel.ibt64:
    arch_allow: x86
    filter: CONFIG_X86_64
    extra_configs:
      - CONFIG_X86_CET_IBT=y
  arch.x86.cet.kernel.shstk64:
    arch_allow: x86
    filter: CONFIG_X86_64
    extra_configs:
      - CONFIG_HW_SHADOW_STACK=y
  arch.x86.cet.kernel.shstk32:
    arch_allow: x86
    filter: not CONFIG_X86_64
    extra_configs:
      - CONFIG_DEBUG_COREDUMP=y
      - CONFIG_HW_SHADOW_STACK=y
