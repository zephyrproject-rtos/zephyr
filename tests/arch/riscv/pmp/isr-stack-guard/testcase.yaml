common:
  platform_allow:
    - qemu_riscv/qemu_virt_riscv/rv32
    - qemu_riscv/qemu_virt_riscv/rv32e
    - qemu_riscv/qemu_virt_riscv/rv64
  filter: CONFIG_RISCV_PMP
  ignore_faults: true

tests:
  arch.riscv.pmp.no-mt.isr-stack-guard:
    extra_args: EXTRA_CFLAGS=-DPMP_TEST_FUNC_IDX=0
    extra_configs:
      - CONFIG_MULTITHREADING=n
  arch.riscv.pmp.no-mt.main-stack-guard:
    extra_args: EXTRA_CFLAGS=-DPMP_TEST_FUNC_IDX=1
    extra_configs:
      - CONFIG_MULTITHREADING=n
  arch.riscv.pmp.mt.isr-stack-guard:
    extra_args: EXTRA_CFLAGS=-DPMP_TEST_FUNC_IDX=0
    extra_configs:
      - CONFIG_MULTITHREADING=y
  arch.riscv.pmp.mt.main-stack-guard:
    extra_args: EXTRA_CFLAGS=-DPMP_TEST_FUNC_IDX=1
    extra_configs:
      - CONFIG_MULTITHREADING=y
