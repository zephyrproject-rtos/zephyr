#Testing
CONFIG_TEST=y
CONFIG_ZTEST=y
CONFIG_NET_TEST=y

# Generic networking options
CONFIG_NETWORKING=y

# CoAP Over Sockets
CONFIG_COAP=y
CONFIG_COAP_WELL_KNOWN_BLOCK_WISE=n
CONFIG_COAP_TEST_API_ENABLE=y

# CoAP Server
CONFIG_COAP_SERVER=y
CONFIG_COAP_SERVER_WELL_KNOWN_CORE=y

# CoAP Client
CONFIG_COAP_CLIENT=y

# CoAP Server Echo support
CONFIG_COAP_SERVER_ECHO=y
CONFIG_COAP_SERVER_ECHO_MAX_LEN=8
CONFIG_COAP_SERVER_ECHO_LIFETIME_MS=60000
CONFIG_COAP_SERVER_ECHO_CACHE_SIZE=4
CONFIG_COAP_SERVER_ECHO_REQUIRE_FOR_UNSAFE=y
CONFIG_COAP_SERVER_ECHO_AMPLIFICATION_MITIGATION=y
CONFIG_COAP_SERVER_ECHO_AMPLIFICATION_FACTOR=3
CONFIG_COAP_SERVER_ECHO_MAX_INITIAL_RESPONSE_BYTES=136

# Kernel options
CONFIG_ENTROPY_GENERATOR=y
CONFIG_TEST_RANDOM_GENERATOR=y

# Logging
CONFIG_NET_LOG=y
CONFIG_COAP_LOG_LEVEL_DBG=y

CONFIG_ZTEST_STACK_SIZE=2048

# Additional requirements for server
CONFIG_ZVFS=y
CONFIG_ZVFS_EVENTFD=y
CONFIG_ZVFS_POLL_MAX=4

# OSCORE support
CONFIG_COAP_OSCORE=y
CONFIG_UOSCORE=y
CONFIG_ZCBOR=y
CONFIG_ZCBOR_CANONICAL=y
CONFIG_COAP_OSCORE_EXCHANGE_CACHE_SIZE=4
CONFIG_COAP_OSCORE_EXCHANGE_LIFETIME_MS=60000

# EDHOC support
# Note: Full EDHOC support requires UEDHOC which has complex mbedtls dependencies.
# For now, we test the basic EDHOC option and parsing functionality without UEDHOC.
CONFIG_COAP_EDHOC=y
# CONFIG_UEDHOC=y  # Disabled due to mbedtls X.509 dependencies
CONFIG_COAP_EDHOC_COMBINED_REQUEST=y
CONFIG_COAP_EDHOC_MAX_COMBINED_PAYLOAD_LEN=1024
CONFIG_COAP_EDHOC_SESSION_CACHE_SIZE=4
CONFIG_COAP_EDHOC_SESSION_LIFETIME_MS=60000
CONFIG_COAP_OSCORE_CTX_CACHE_SIZE=4
CONFIG_COAP_OSCORE_CTX_LIFETIME_MS=3600000

# EDHOC over CoAP transport (RFC 9528 Appendix A.2)
CONFIG_COAP_SERVER_WELL_KNOWN_EDHOC=y

# Q-Block support
CONFIG_COAP_Q_BLOCK=y
