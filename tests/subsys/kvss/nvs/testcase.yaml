common:
  tags: nvs
tests:
  keyvalstorage.nvs:
    platform_allow:
      - qemu_x86
      - mps2/an385
  keyvalstorage.nvs.0x00:
    extra_args: DTC_OVERLAY_FILE=boards/qemu_x86_ev_0x00.overlay
    platform_allow: qemu_x86
  keyvalstorage.nvs.sim.no_erase:
    extra_args: CONFIG_FLASH_SIMULATOR_EXPLICIT_ERASE=n
    platform_allow: qemu_x86
  keyvalstorage.nvs.cache:
    extra_args:
      - CONFIG_NVS_LOOKUP_CACHE=y
      - CONFIG_NVS_LOOKUP_CACHE_SIZE=64
    platform_allow: native_sim
  keyvalstorage.nvs.data_crc:
    extra_args:
      - CONFIG_NVS_DATA_CRC=y
    platform_allow:
      - native_sim
      - qemu_x86
  keyvalstorage.nvs.data_crc_cache:
    extra_args:
      - CONFIG_NVS_DATA_CRC=y
      - CONFIG_NVS_LOOKUP_CACHE=y
      - CONFIG_NVS_LOOKUP_CACHE_SIZE=64
    platform_allow: native_sim
  keyvalstorage.nvs.64kb_erase_block:
    extra_args: DTC_OVERLAY_FILE=boards/native_sim_64kb_erase_block.overlay
    platform_allow: native_sim
