/*
 * Copyright (c) 2025 sevenlab engineering GmbH
 *
 * SPDX-License-Identifier: Apache-2.0
 */

#ifndef LOGGER3G_DRIVERS_AUDIO_TAA3020_H_
#define LOGGER3G_DRIVERS_AUDIO_TAA3020_H_

#include <zephyr/sys/util.h>

enum taa3020_channel_in_type {
	TAA3020_CHANNEL_IN_TYPE_MICROPHONE = 0,
	TAA3020_CHANNEL_IN_TYPE_LINE = 1,
};

enum taa3020_channel_in_src {
	TAA3020_CHANNEL_IN_SRC_ANALOG_DIFFERENTIAL = 0,
	TAA3020_CHANNEL_IN_SRC_ANALOG_SIGNLE_ENDED = 1,
	TAA3020_CHANNEL_IN_SRC_PDM = 2,
};

enum taa3020_channel_coupling {
	TAA3020_CHANNEL_COUPLING_AC = 0,
	TAA3020_CHANNEL_COUPLING_DC = 1,
};

enum taa3020_channel_impedance {
	TAA3020_CHANNEL_IMPEDANCE_2_5K = 0,
	TAA3020_CHANNEL_IMPEDANCE_10K = 1,
	TAA3020_CHANNEL_IMPEDANCE_20K = 2,
};

#define TAA3020_PAGE_CFG      0x00
#define TAA3020_SW_RESET      0x01
#define TAA3020_SLEEP_CFG     0x02
#define TAA3020_SHDN_CFG      0x05
#define TAA3020_ASI_CFG0      0x07
#define TAA3020_ASI_CH1       0xb
#define TAA3020_ASI_CH2       0xc
#define TAA3020_ASI_CH3       0xd
#define TAA3020_ASI_CH4       0xe
#define TAA3020_CH1_CFG0      0x3C
#define TAA3020_CH1_CFG2      0x3E
#define TAA3020_CH2_CFG0      0x41
#define TAA3020_CH2_CFG2      0x43
#define TAA3020_CH3_CFG2      0x48
#define TAA3020_CH4_CFG2      0x4D
#define TAA3020_IN_CH_EN      0x73
#define TAA3020_ASI_OUT_CH_EN 0x74
#define TAA3020_PWR_CFG       0x75

#define TAA3020_SW_RESET_SW_RESET BIT(0)

#define TAA3020_SLEEP_CFG_AREG_SELECT BIT(7)
#define TAA3020_SLEEP_CFG_SLEEP_ENZ   BIT(0)

#define TAA3020_ASI_CHx_RIGHT     BIT(5)
#define TAA3020_ASI_CHx_SLOT_MASK GENMASK(4, 0)
#define TAA3020_ASI_CHx_SLOT(x)   FIELD_PREP(TAA3020_ASI_CHx_SLOT_MASK, x)

#define TAA3020_ASI_CFG0_ASI_FORMAT_MASK           GENMASK(7, 6)
#define TAA3020_ASI_CFG0_ASI_FORMAT_TDM            FIELD_PREP(TAA3020_ASI_CFG0_ASI_FORMAT_MASK, 0)
#define TAA3020_ASI_CFG0_ASI_FORMAT_I2S            FIELD_PREP(TAA3020_ASI_CFG0_ASI_FORMAT_MASK, 1)
#define TAA3020_ASI_CFG0_ASI_FORMAT_LEFT_JUSTIFIED FIELD_PREP(TAA3020_ASI_CFG0_ASI_FORMAT_MASK, 2)
#define TAA3020_ASI_CFG0_ASI_WLEN_MASK             GENMASK(5, 4)
#define TAA3020_ASI_CFG0_ASI_WLEN_16BIT            FIELD_PREP(TAA3020_ASI_CFG0_ASI_WLEN_MASK, 0)
#define TAA3020_ASI_CFG0_ASI_WLEN_20BIT            FIELD_PREP(TAA3020_ASI_CFG0_ASI_WLEN_MASK, 1)
#define TAA3020_ASI_CFG0_ASI_WLEN_24BIT            FIELD_PREP(TAA3020_ASI_CFG0_ASI_WLEN_MASK, 2)
#define TAA3020_ASI_CFG0_ASI_WLEN_32BIT            FIELD_PREP(TAA3020_ASI_CFG0_ASI_WLEN_MASK, 3)
#define TAA3020_ASI_CFG0_ASI_FSYNC_POL             BIT(3)
#define TAA3020_ASI_CFG0_ASI_BCLK_POL              BIT(2)
#define TAA3020_ASI_CFG0_ASI_TX_EDGE               BIT(1)
#define TAA3020_ASI_CFG0_ASI_TX_FILL               BIT(0)

#define TAA3020_CHx_CFG0_INTYP                     GENMASK(7, 7)
#define TAA3020_CHx_CFG0_INTYP_MICROPHONE          FIELD_PREP(TAA3020_CHx_CFG0_INTYP, 0)
#define TAA3020_CHx_CFG0_INTYP_LINE                FIELD_PREP(TAA3020_CHx_CFG0_INTYP, 1)
#define TAA3020_CHx_CFG0_INSRC                     GENMASK(6, 5)
#define TAA3020_CHx_CFG0_INSRC_ANALOG_DIFFERENTIAL FIELD_PREP(TAA3020_CHx_CFG0_INSRC, 0)
#define TAA3020_CHx_CFG0_INSRC_ANALOG_SINGLE_ENDED FIELD_PREP(TAA3020_CHx_CFG0_INSRC, 1)
#define TAA3020_CHx_CFG0_INSRC_PDM                 FIELD_PREP(TAA3020_CHx_CFG0_INSRC, 2)
#define TAA3020_CHx_CFG0_DC                        BIT(4)
#define TAA3020_CHx_CFG0_IMPEDANCE                 GENMASK(3, 2)
#define TAA3020_CHx_CFG0_IMPEDANCE_2_5K            FIELD_PREP(TAA3020_CHx_CFG0_IMPEDANCE, 0)
#define TAA3020_CHx_CFG0_IMPEDANCE_10K             FIELD_PREP(TAA3020_CHx_CFG0_IMPEDANCE, 1)
#define TAA3020_CHx_CFG0_IMPEDANCE_20K             FIELD_PREP(TAA3020_CHx_CFG0_IMPEDANCE, 2)
#define TAA3020_CHx_CFG0_AGCEN                     BIT(0)

#define TAA3020_CHx_CFG2_DVOL_MIN 0
#define TAA3020_CHx_CFG2_DVOL_MAX 255

#define TAA3020_IN_CH_EN_MASK       GENMASK(7, 4)
#define TAA3020_IN_CH_EN_CHANNEL(x) (1 << (7 - x))

#define TAA3020_ASI_OUT_CH_EN_MASK       GENMASK(7, 4)
#define TAA3020_ASI_OUT_CH_EN_CHANNEL(x) (1 << (7 - x))

#define TAA3020_PWR_CFG_ADC_PDZ        BIT(6)
#define TAA3020_PWR_CFG_PLL_PDZ        BIT(5)
#define TAA3020_PWR_CFG_DYN_CH_PUPD_EN BIT(4)

#endif /* LOGGER3G_DRIVERS_AUDIO_TAA3020_H_ */
