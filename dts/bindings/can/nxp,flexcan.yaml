# Copyright (c) 2019-2026 Vestas Wind Systems A/S
# SPDX-License-Identifier: Apache-2.0

description: |
  NXP FlexCAN controller

compatible: "nxp,flexcan"

include: ["can-controller.yaml", "pinctrl-device.yaml"]

properties:
  reg:
    required: true

  interrupts:
    required: true

  clocks:
    required: true

  clock-names:
    description: |
      Required if the "clk-source" property is present.

  clk-source:
    type: int
    enum:
      - 0
      - 1
    description: |
      CAN engine clock source. The value of this property, if present, selects the corresponding
      named clock from the "clocks" property. A value of "0" selects "clksrc0" whereas a value of
      "1" selects "clksrc1".

      The value of this property is written to the CLKSRC bit of the FlexCAN CTRL1 register for
      controlling the 1-bit, internal clock multiplexer.

      Omit this property for FlexCAN instances that do not have a 1-bit, internal multiplexer
      (FlexCAN CTRL1 register bit 13 is marked as "reserved").

  number-of-mb:
    type: int
    enum:
      - 16
      - 32
      - 64
      - 96
      - 128
    required: true
    description: |
      Number of 8-byte sized message buffers (MBs) supported by this FlexCAN instance. CAN FD mode,
      if supported, uses 64-byte sized MBs, resulting in fewer available MBs.

  max-filters:
    type: int
    description: |
      Maximum number of concurrently active RX filters. The allowed range value depends on the
      number of available message buffers for the FlexCAN instance.

      If this property is not set, the default maximum number of RX filters set via Kconfig will be
      used instead.

examples:
  - |
    flexcan0: can@40024000 {
      status = "okay";
      compatible = "nxp,flexcan";
      reg = <0x40024000 0x1000>;
      interrupts = <78 0>, <79 0>, <80 0>, <81 0>;
      interrupt-names = "warning", "error", "wake-up", "mb-0-15";
      clocks = <&scg KINETIS_SCG_BUS_CLK>;
      clock-names = "clksrc1";
      clk-source = <1>;
      number-of-mb = <16>;
      pinctrl-0 = <&pinmux_flexcan0>;
      pinctrl-names = "default";

      can-transceiver {
        max-bitrate = <1000000>;
      };
    };
