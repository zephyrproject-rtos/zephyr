# Copyright (c) 2025 Croxel Inc.
# Copyright (c) 2025 CogniPilot Foundation
# SPDX-License-Identifier: Apache-2.0

description: |
    AFBR-S50 3D ToF sensor

    This sensor requires the SPI bus attached to it, to define the following
    pinctrl states:
    - pinctrl-0: default (SPI mode).
    - pinctrl-1: GPIO mode (used to access the internal EEPROM).

    It also requires defining the GPIO pins used for the SPI bus in GPIO mode,
    under the AFBR node.

    Example:

    &spi_bus {
        status = "okay";
        pinctrl-0 = <&spi_bus_default>;
        pinctrl-1 = <&spi_bus_gpio>;
        pinctrl-names = "default", "priv_start";
        ...

        afbr_s50: afbr_s50@0 {
          compatible = "brcm,afbr-s50";
          reg = <0>;
          spi-max-frequency = <10000000>;
          int-gpios = <&gpio0 10 (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>;
          spi-mosi-gpios = <&gpio0 24 GPIO_ACTIVE_HIGH>;
          spi-sck-gpios = <&gpio0 25 GPIO_ACTIVE_HIGH>;
          spi-miso-gpios = <&gpio0 26 GPIO_ACTIVE_HIGH>;
        };
    };

compatible: "brcm,afbr-s50"
include: [sensor-device.yaml, spi-device.yaml]

properties:
  int-gpios:
    type: phandle-array
    required: true
    description: |
      The INT signal default configuration is active-low. The
      property value should ensure the flags properly describe the
      signal that is presented to the driver.

  spi-mosi-gpios:
    type: phandle-array
    required: true
    description: |
      SPI MOSI GPIO pin. Used by the driver in order to use the bus in GPIO
      mode, which is required to interact with the internal EEPROM the
      AFBR contains (mandatory).
      This property is required since the SPI bus is configured and used
      through pinctrl, which is not directly mapped to a GPIO port/pin.

  spi-miso-gpios:
    type: phandle-array
    required: true
    description: |
      SPI MISO GPIO pin. Used by the driver in order to use the bus in GPIO
      mode, which is required to interact with the internal EEPROM the
      AFBR contains (mandatory).
      This property is required since the SPI bus is configured and used
      through pinctrl, which is not directly mapped to a GPIO port/pin.

  spi-sck-gpios:
    type: phandle-array
    required: true
    description: |
      SPI CLK GPIO pin. Used by the driver in order to use the bus in GPIO
      mode, which is required to interact with the internal EEPROM the
      AFBR contains (mandatory).
      This property is required since the SPI bus is configured and used
      through pinctrl, which is not directly mapped to a GPIO port/pin.
