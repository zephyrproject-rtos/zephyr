# Copyright (c) 2024 Gerson Fernando Budke <nandojve@gmail.com>
# Copyright (c) 2025 Altronix
# SPDX-License-Identifier: Apache-2.0

description: Atmel SAM0 SERCOM UART driver

compatible: "atmel,sam0-uart"

include:
  - name: uart-controller.yaml
  - name: pinctrl-device.yaml
  - name: atmel,assigned-clocks.yaml

properties:
  reg:
    required: true

  interrupts:
    required: true

  clocks:
    required: true

  clock-names:
    required: true

  atmel,assigned-clocks:
    required: true

  atmel,assigned-clock-names:
    required: true

  rxpo:
    type: int
    required: true
    description: |
      Receive Data Pinout. An enumeration with the following values:

      +-------+---------------+
      | Value | RX Pin        |
      +-------+---------------+
      |     0 | SERCOM_PAD[0] |
      +-------+---------------+
      |     1 | SERCOM_PAD[1] |
      +-------+---------------+
      |     2 | SERCOM_PAD[2] |
      +-------+---------------+
      |     3 | SERCOM_PAD[3] |
      +-------+---------------+


  txpo:
    type: int
    required: true
    description: |
      Transmit Data Pinout. An enumeration with values that depend on the
      hardware being used. This controls both the transmit pins and if
      hardware flow control is used.

      SAMD20:

      +-------+---------------+
      | Value | TX Pin        |
      +-------+---------------+
      |     0 | SERCOM_PAD[0] |
      +-------+---------------+
      |     1 | SERCOM_PAD[2] |
      +-------+---------------+

      SAMD21/DA21/R21:

      +-------+---------------+---------------+---------------+
      | Value | TX Pin        | RTS           | CTS           |
      +-------+---------------+---------------+---------------+
      |     0 | SERCOM_PAD[0] |           N/A |           N/A |
      +-------+---------------+---------------+---------------+
      |     1 | SERCOM_PAD[2] |           N/A |           N/A |
      +-------+---------------+---------------+---------------+
      |     2 | SERCOM_PAD[0] | SERCOM_PAD[2] | SERCOM_PAD[3] |
      +-------+---------------+---------------+---------------+
      |     3 | Reserved                                      |
      +-------+-----------------------------------------------+

      SAML2x/C2x:

      +-------+----------------+---------------+--------------+
      | Value | TX Pin        | RTS           | CTS           |
      +-------+---------------+---------------+---------------+
      |     0 | SERCOM_PAD[0] |           N/A |           N/A |
      +-------+---------------+---------------+---------------+
      |     1 | SERCOM_PAD[2] |           N/A |           N/A |
      +-------+---------------+---------------+---------------+
      |     2 | SERCOM_PAD[0] | SERCOM_PAD[2] | SERCOM_PAD[3] |
      +-------+---------------+---------------+---------------+
      |     3 | SERCOM_PAD[0] | SERCOM_PAD[2] |           N/A |
      +-------+---------------+---------------+---------------+

      SAMD5/E5:

      +-------+---------------+---------------+---------------+
      | Value | TX Pin        | RTS           | CTS           |
      +-------+---------------+---------------+---------------+
      |     0 | SERCOM_PAD[0] |           N/A |           N/A |
      +-------+---------------+---------------+---------------+
      |     1 | Reserved                                      |
      +-------+---------------+---------------+---------------+
      |     2 | SERCOM_PAD[0] | SERCOM_PAD[2] | SERCOM_PAD[3] |
      +-------+---------------+---------------+---------------+
      |     3 | SERCOM_PAD[0] | SERCOM_PAD[2] |           N/A |
      +-------+---------------+---------------+---------------+


  collision-detection:
    type: boolean
    description: Enable collision detection for half-duplex mode.

  dmas:
    description: |
      Optional TX & RX dma specifiers.  Each specifier will have a phandle
      reference to the dmac controller, the channel number, and peripheral
      trigger source.

      For example dmas for TX, RX on SERCOM3
         dmas = <&dmac 0 0xb>, <&dmac 0 0xa>;

  dma-names:
    description: |
      Required if the dmas property exists.  This should be "tx" and "rx"
      to match the dmas property.

      For example
         dma-names = "tx", "rx";

  de-gpios:
    type: phandle-array
    description: |
      RS485 Driver Enable GPIO. Controls transmitter enable on RS485 transceiver.
      Polarity configured via GPIO_ACTIVE_HIGH or GPIO_ACTIVE_LOW flag.

  re-gpios:
    type: phandle-array
    description: |
      RS485 Receiver Enable GPIO. Controls receiver enable on RS485 transceiver.
      Polarity configured via GPIO_ACTIVE_HIGH or GPIO_ACTIVE_LOW flag.
      Note: Many transceivers have DE/RE tied together; in this case only
      specify de-gpios.

examples:
  - |
    uart0: uart@42000800 {
      compatible = "atmel,sam0-uart";
      reg = <0x42000800 0x40>;
      interrupts = <9 0>;
      clocks = <&gclk 0x14>;
      clock-names = "GCLK";
      current-speed = <115200>;
      rxpo = <1>;
      txpo = <0>;
      de-gpios = <&porta 22 GPIO_ACTIVE_HIGH>;
    };
