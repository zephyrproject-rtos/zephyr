# Copyright (c) 2020 Vestas Wind Systems A/S
# SPDX-License-Identifier: Apache-2.0

description: NXP LPTMR

compatible: "nxp,lptmr"

include: [rtc.yaml, wuc-device.yaml]

properties:
  reg:
    required: true

  clock-frequency:
    required: true
    description: Counter clock frequency

  prescaler:
    type: int
    deprecated: true
    description: |
      This property has been deprecated and replaced by prescale-glitch-filter.
      It no longer has any functional impact. Any value assigned to this property
      will be disregarded. Consequently, the prescaler will be bypassed.

  clk-source:
    type: int
    required: true
    enum: [0, 1, 2, 3]
    description: |
      Selects the clock to be used by the LPMTR prescaler/glitch filter.
      In time counter mode, this field selects the input clock to the prescaler.
      In pulse counter mode, this field selects the input clock to the glitch filter.
      The clock connections vary by device, see the device reference manual for
      more details.

  input-pin:
    type: int
    description: |
      When LPTMR is in Pulse mode, this value
      will be used to determine the "rising-edge
      source pin" to increment the lptmr counter.

  active-low:
    type: boolean
    description: |
      When LPTMR is in Pulse mode, this value
      will set the counter to active low.

  resolution:
    type: int
    required: true
    description: Represents the width of the counter in bits.

  prescale-glitch-filter-bypass:
    type: boolean
    description: |
      Controls the clocking of Counter (CNR). If false, the output of the prescaler
      or glitch filter clocks CNR. If true, the selected prescaler clock in Time
      Counter mode, or the selected input source in Pulse Counter mode, directly
      clocks CNR.

  prescale-glitch-filter:
    type: int
    default: 0
    enum: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
    description: |
      Configures the size of the prescaler in Time Counter mode and the width of the
      glitch filter in Pulse Counter mode.

      Note: If ``prescale-glitch-filter-bypass`` is set, this property is ignored.
      When in prescaler mode, prescaler divides the prescaler clock by
        2^(prescaler-glitch-filter + 1)
      When in pulse mode, prescale-glitch-filter = 0 is not supported for glitch
        filtering. To request no filtering, set ``prescale-glitch-filter-bypass``.
        If prescale-glitch-filter is greater than 0, glitch filter recognizes change
        on input pin after 2^prescale-glitch-filter rising clock edges.

  timer-mode-sel:
    type: int
    enum: [0, 1]
    default: 0
    description: |
      This value determines rather the LPTMR is configured
      for Time-Counter mode or for Pulse mode.
      0 <- LPTMR is configured for Time Counter Mode.
      1 <- LPTMR is configured for Pulse Mode.

  run-mode:
    type: string
    description: |
      Selects how the LPTMR counter behaves on compare events.
      - restart(default): Counter resets after matching the compare value.
      - free-run: Compare events do not reset the counter; it resets on overflow.
    enum:
      - restart
      - free-run
    default: restart
