# Copyright (c) 2025 Core Devices LLC
# Copyright (c) 2025 SiFli Technologies(Nanjing) Co., Ltd
# SPDX-License-Identifier: Apache-2.0

description: |
  SiFli Reset and Clock Controller (RCC) is a multi-function peripheral in
  charge of reset control and clock control for all SoC peripherals. This
  binding represents the clock controller part. It is meant to be used as a
  child node of the RCC node. This is due to the fact Zephyr does not allow
  >1 device referencing to the same devicetree node (e.g. clock and reset
  devices).

  To specify the clocks in a peripheral, the standard clocks property needs
  to be used, e.g.:

    usart1: serial@xxx {
        ...
        /* cell encodes RCC register offset and control bit position */
        clocks = <&rcc_clk SF32LB52X_CLOCK_USART1>;
        ...
    }

  Predefined RCC clock cells are available in
  include/zephyr/dts-bindings/clock/sf32lb{xxx}-clocks.h header files, where
  {xxx} corresponds to the SoC series, e.g. sf32lb52x.

compatible: "sifli,sf32lb-rcc-clk"

include:
  - base.yaml
  - clock-controller.yaml
  - sifli-sf32lb-cfg.yaml
  - sifli-sf32lb-pmuc.yaml

properties:
  clocks:
    required: true

  clock-names:
    required: true

  "#clock-cells":
    const: 1

  sifli,cfg:
    required: true

  sifli,pmuc:
    required: true

  sifli,hdiv:
    type: int
    required: true
    description: |
      Divider for HCLK (0-255). fHCLK = clk_hpsys / HDIV.

  sifli,pdiv1:
    type: int
    required: true
    description: |
      Divider for PCLK1 (0-7). fPCLK1 = fHCLK / 2^PDIV1.

  sifli,pdiv2:
    type: int
    required: true
    description: |
      Divider for PCLK2 (0-7). fPCLK2 = fHCLK / 2^PDIV2.

  sifli,sys-clk-src:
    type: string
    enum: ["hrc48", "hxt48", "dll1"]
    default: "hrc48"
    description: |
      Source used for the HPSYS system clock. When set to ``dll1`` the DLL1 child
      node must be enabled. Defaults to ``hrc48`` if not provided (reset default).

  sifli,peri-clk-src:
    type: string
    enum: ["hrc48", "hxt48"]
    default: "hxt48"
    description: |
      Source used for the HPSYS peripheral clock domain. Defaults to ``hxt48`` if
      not provided (reset default).

  sifli,mpi1-clk-src:
    type: string
    enum: ["peri", "dll1", "dll2"]
    default: "peri"
    description: |
      Source used for the MPI1/QSPI clock tree. Selecting ``dll1`` or ``dll2``
      requires the corresponding DLL child node to be enabled. Defaults to
      ``peri`` if not provided (reset default).

  sifli,mpi2-clk-src:
    type: string
    enum: ["peri", "dll1", "dll2"]
    default: "peri"
    description: |
      Source used for the MPI2/QSPI clock tree. Selecting ``dll1`` or ``dll2``
      requires the corresponding DLL child node to be enabled. Defaults to
      ``peri`` if not provided (reset default).

  sifli,usb-clk-src:
    type: string
    enum: ["sysclk", "dll2"]
    default: "sysclk"
    description: |
      Source used for the USB full-speed controller clock. Selecting ``dll2``
      requires the DLL2 child node to be enabled. Defaults to ``sysclk`` if not
      provided (reset default).

  sifli,usb-div:
    type: int
    default: 4
    description: |
      Divider applied to the selected USB clock source. The divided clock must
      be 60 MHz. For example, when ``clk_dll2`` runs at 240 MHz the divider must
      be ``4`` (reset default).

clock-cells:
  - id
