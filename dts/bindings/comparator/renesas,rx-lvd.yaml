# Copyright (c) 2025 Renesas Electronics Corporation
# SPDX-License-Identifier: Apache-2.0

description: |
  Renesas RX LVD (Low-voltage detection) Controller

  The following example displays the minimum node layout:

    lvd: lvd@800e2 {
            compatible = "renesas,rx-lvd";
            reg = <0x000800e2 0x02>;
            interrupts = <89 1>;
            status = "disabled";
    };

  Enabling the comparator controller node requires setting the minimum
  default configuration of the comparator. This includes selecting the
  positive and negative inputs.
  Note: negative input of this controller is selected through specific
  voltage threshold levels, and positive input can be either Vcc or CMPA pin.
  If CMPA pin is selected as positive input, pinctrl must be defined to
  route CMPA pin to the controller.

      &pinctrl {
                lvd1_cmpa: lvd1_cmpa {
                        group1 {
                                /* CMPA */
                                psels = <RX_PSEL(RX_PSEL_LVD, ..., ...)>;
                                renesas,analog-enable;
                                input-enable;
                        };
                };
        };

      &lvd1 {
            pinctrl-0 = <&lvd1_cmpa>;
            pinctrl-names = "default";
            lvd-action = "maskable-interrupt";
            voltage_level = <384>;
            vdet-target = "cmpa";
            lvd-trigger = "rising";
            lvd-stabilization = <0>;
            status = "okay";
      };

compatible: "renesas,rx-lvd"

include: [base.yaml, pinctrl-device.yaml]

properties:
  reg:
    required: true

  channel:
    type: int
    required: true

  lvd-action:
    required: true
    type: string
    enum:
      - "reset"
      - "non-maskable-interrupt"
      - "maskable-interrupt"
      - "no-action"
    description: |
      Choose the action to be taken when the LVD is detected.

  lvd-support-cmpa:
    type: boolean
    description: |
      Specifies whether the RX LVD supports CMPA pin as target.

  voltage-level:
    required: true
    type: int
    description: |
      Specifies the voltage detection level for each channel, as an integer
      value that represents the voltage in hundredths of a volt.
      Example:
        - To set the voltage detection level to 3.00 V, specify '300'.
        - To set the voltage detection level to 3.84 V, specify '384'.
        - To set the voltage detection level to default value, specify '0xFFFF'
      For specific voltage detection support levels of each RX MCU series,
      please refer to the HWM.

  vdet-target:
    required: true
    type: string
    enum:
      - vcc
      - cmpa
    description: |
      Specifies the target to be monitored for each channel.
      Not all RX LVD channels support CMPA pin as target.
      Please refer to the HWM for details.

  lvd-trigger:
    required: true
    type: string
    enum:
      - "rising"
      - "falling"
      - "both"
    description: |
      Specifies the voltage detection conditions and influences interrupt conditions

  lvd-stabilization:
    type: int
    enum: [0, 1]
    description: |
      Specifies the reset negation timing for each channel, with reset selected as processing.
        - 0: After a LVD reset, negation occurs when a certain period elapses after the
          monitored voltage goes above the voltage detection level.
        - 1: Negation occurs when a certain period elapses after the LVD reset assertion.
      Note: "a certain period" here means a wait time after a voltage monitoring reset.
            Refer to the User's Manual: Hardware for details.

  pinctrl-0:
    description: Pin control for LVD when using CMPA pin as target

  pinctrl-names:
    description: Pin control names for LVD when using CMPA pin as target
