source [find interface/stlink-dap.cfg]
transport select dapdirect_swd

# If you use an OpenOCD version higher than 0.12.0 and your target embeds
# an ST-Link firmware earlier than v2j24, connection will not work.
# It is recommended to upgrade the ST-Link firmware of the target,
# however, if not possible, the 2 lines above can be replaced with the
# following to connect successfully:
#
# source [find interface/stlink-hla.cfg]
# transport select hla_swd

set WORKAREASIZE 0x10000

source [find target/stm32f4x.cfg]

$_TARGETNAME configure -event gdb-attach {
        echo "Debugger attaching: halting execution"
        reset halt
        gdb_breakpoint_override hard
}

$_TARGETNAME configure -event gdb-detach {
        echo "Debugger detaching: resuming execution"
        resume
}
