/*
 * Copyright (c) 1997-2010, 2012-2014 Wind River Systems, Inc.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

#include <zephyr/types.h>
#include <zephyr/sys/__assert.h>
#include "version.h" /* generated by MAKE, at compile time */

/**
 * @brief Return the kernel version of the present build
 *
 * The kernel version is a four-byte value, whose format is described in the
 * file "kernel_version.h".
 *
 * @return kernel version
 */
uint32_t sys_kernel_version_get(void)
{
	return KERNELVERSION;
}

#ifdef CONFIG_LINKER_GNU_BUILD_ID

/* Structure of .elf notes */
struct elf_note_section {
	uint32_t name_sz;
	uint32_t desc_sz;
	uint32_t type;
	uint8_t data[];
};

/* Variable instantiated by the linker */
extern const struct elf_note_section __g_note_build_id;

const uint8_t *sys_gnu_build_id_get(void)
{
	__ASSERT_NO_MSG(__g_note_build_id.desc_sz == 20);
	return &__g_note_build_id.data[__g_note_build_id.name_sz];
}

#endif /* CONFIG_LINKER_GNU_BUILD_ID */
